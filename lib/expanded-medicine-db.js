export const expandedMedicineDB = {
    "paracetamol": { category: "Pain & Fever", branded: "Crocin 500mg", brandedPrice: 30, activeIngredient: "Paracetamol", uses: "Fever, Pain relief, Headache", alternatives: [{ name: "Paracetamol 500mg", manufacturer: "Jan Aushadhi", price: 2, savings: 93 }, { name: "Paracetamol 500mg", manufacturer: "IDPL", price: 2.5, savings: 92 }] },
    "ibuprofen": { category: "Pain & Inflammation", branded: "Brufen 400mg", brandedPrice: 45, activeIngredient: "Ibuprofen", uses: "Pain, Inflammation, Arthritis", alternatives: [{ name: "Ibuprofen 400mg", manufacturer: "Jan Aushadhi", price: 3, savings: 93 }] },
    "aspirin": { category: "Blood Thinner", branded: "Disprin 75mg", brandedPrice: 35, activeIngredient: "Aspirin", uses: "Blood thinning, Heart protection", alternatives: [{ name: "Aspirin 75mg", manufacturer: "Jan Aushadhi", price: 2.5, savings: 93 }] },
    "metformin": { category: "Diabetes", branded: "Glycomet 500mg", brandedPrice: 45, activeIngredient: "Metformin", uses: "Type 2 Diabetes", alternatives: [{ name: "Metformin 500mg", manufacturer: "Jan Aushadhi", price: 5, savings: 89 }] },
    "glimepiride": { category: "Diabetes", branded: "Amaryl 2mg", brandedPrice: 120, activeIngredient: "Glimepiride", uses: "Type 2 Diabetes", alternatives: [{ name: "Glimepiride 2mg", manufacturer: "Jan Aushadhi", price: 8, savings: 93 }] },
    "amlodipine": { category: "Blood Pressure", branded: "Amlong 5mg", brandedPrice: 60, activeIngredient: "Amlodipine", uses: "High BP, Hypertension", alternatives: [{ name: "Amlodipine 5mg", manufacturer: "Jan Aushadhi", price: 4, savings: 93 }] },
    "atenolol": { category: "Blood Pressure", branded: "Tenormin 50mg", brandedPrice: 55, activeIngredient: "Atenolol", uses: "High BP, Angina", alternatives: [{ name: "Atenolol 50mg", manufacturer: "Jan Aushadhi", price: 3, savings: 95 }] },
    "losartan": { category: "Blood Pressure", branded: "Losar 50mg", brandedPrice: 85, activeIngredient: "Losartan", uses: "High BP", alternatives: [{ name: "Losartan 50mg", manufacturer: "Jan Aushadhi", price: 5, savings: 94 }] },
    "atorvastatin": { category: "Cholesterol", branded: "Lipitor 10mg", brandedPrice: 150, activeIngredient: "Atorvastatin", uses: "High cholesterol", alternatives: [{ name: "Atorvastatin 10mg", manufacturer: "Jan Aushadhi", price: 8, savings: 95 }] },
    "omeprazole": { category: "Acidity", branded: "Omez 20mg", brandedPrice: 80, activeIngredient: "Omeprazole", uses: "Acidity, GERD", alternatives: [{ name: "Omeprazole 20mg", manufacturer: "Jan Aushadhi", price: 6, savings: 93 }] },
    "pantoprazole": { category: "Acidity", branded: "Pan 40mg", brandedPrice: 90, activeIngredient: "Pantoprazole", uses: "Acidity, Ulcers", alternatives: [{ name: "Pantoprazole 40mg", manufacturer: "Jan Aushadhi", price: 7, savings: 92 }] },
    "ranitidine": { category: "Acidity", branded: "Aciloc 150mg", brandedPrice: 40, activeIngredient: "Ranitidine", uses: "Acidity, Heartburn", alternatives: [{ name: "Ranitidine 150mg", manufacturer: "Jan Aushadhi", price: 3, savings: 93 }] },
    "cetirizine": { category: "Allergy", branded: "Zyrtec 10mg", brandedPrice: 50, activeIngredient: "Cetirizine", uses: "Allergy, Itching", alternatives: [{ name: "Cetirizine 10mg", manufacturer: "Jan Aushadhi", price: 2, savings: 96 }] },
    "montelukast": { category: "Asthma", branded: "Montair 10mg", brandedPrice: 120, activeIngredient: "Montelukast", uses: "Asthma, Allergies", alternatives: [{ name: "Montelukast 10mg", manufacturer: "Jan Aushadhi", price: 10, savings: 92 }] },
    "salbutamol": { category: "Asthma", branded: "Asthalin", brandedPrice: 100, activeIngredient: "Salbutamol", uses: "Asthma, Breathing", alternatives: [{ name: "Salbutamol", manufacturer: "Jan Aushadhi", price: 15, savings: 85 }] },
    "azithromycin": { category: "Antibiotic", branded: "Azithral 500mg", brandedPrice: 150, activeIngredient: "Azithromycin", uses: "Bacterial infections", alternatives: [{ name: "Azithromycin 500mg", manufacturer: "Jan Aushadhi", price: 20, savings: 87 }] },
    "amoxicillin": { category: "Antibiotic", branded: "Mox 500mg", brandedPrice: 80, activeIngredient: "Amoxicillin", uses: "Bacterial infections", alternatives: [{ name: "Amoxicillin 500mg", manufacturer: "Jan Aushadhi", price: 8, savings: 90 }] },
    "ciprofloxacin": { category: "Antibiotic", branded: "Cifran 500mg", brandedPrice: 100, activeIngredient: "Ciprofloxacin", uses: "Bacterial infections", alternatives: [{ name: "Ciprofloxacin 500mg", manufacturer: "Jan Aushadhi", price: 10, savings: 90 }] },
    "doxycycline": { category: "Antibiotic", branded: "Doxy 100mg", brandedPrice: 90, activeIngredient: "Doxycycline", uses: "Bacterial infections", alternatives: [{ name: "Doxycycline 100mg", manufacturer: "Jan Aushadhi", price: 8, savings: 91 }] },
    "levothyroxine": { category: "Thyroid", branded: "Eltroxin 50mcg", brandedPrice: 70, activeIngredient: "Levothyroxine", uses: "Hypothyroidism", alternatives: [{ name: "Levothyroxine 50mcg", manufacturer: "Jan Aushadhi", price: 5, savings: 93 }] },
    "diclofenac": { category: "Pain", branded: "Voveran 50mg", brandedPrice: 60, activeIngredient: "Diclofenac", uses: "Pain, Inflammation", alternatives: [{ name: "Diclofenac 50mg", manufacturer: "Jan Aushadhi", price: 4, savings: 93 }] },
    "tramadol": { category: "Pain", branded: "Ultracet", brandedPrice: 120, activeIngredient: "Tramadol", uses: "Moderate to severe pain", alternatives: [{ name: "Tramadol 50mg", manufacturer: "Jan Aushadhi", price: 12, savings: 90 }] },
    "gabapentin": { category: "Nerve Pain", branded: "Gabapin 300mg", brandedPrice: 150, activeIngredient: "Gabapentin", uses: "Nerve pain, Seizures", alternatives: [{ name: "Gabapentin 300mg", manufacturer: "Jan Aushadhi", price: 15, savings: 90 }] },
    "pregabalin": { category: "Nerve Pain", branded: "Lyrica 75mg", brandedPrice: 200, activeIngredient: "Pregabalin", uses: "Nerve pain", alternatives: [{ name: "Pregabalin 75mg", manufacturer: "Jan Aushadhi", price: 25, savings: 88 }] },
    "insulin": { category: "Diabetes", branded: "Lantus", brandedPrice: 800, activeIngredient: "Insulin Glargine", uses: "Diabetes", alternatives: [{ name: "Insulin Glargine", manufacturer: "Jan Aushadhi", price: 400, savings: 50 }] },
    "clopidogrel": { category: "Blood Thinner", branded: "Plavix 75mg", brandedPrice: 180, activeIngredient: "Clopidogrel", uses: "Blood clot prevention", alternatives: [{ name: "Clopidogrel 75mg", manufacturer: "Jan Aushadhi", price: 15, savings: 92 }] },
    "warfarin": { category: "Blood Thinner", branded: "Coumadin 5mg", brandedPrice: 100, activeIngredient: "Warfarin", uses: "Blood clot prevention", alternatives: [{ name: "Warfarin 5mg", manufacturer: "Jan Aushadhi", price: 8, savings: 92 }] },
    "furosemide": { category: "Diuretic", branded: "Lasix 40mg", brandedPrice: 50, activeIngredient: "Furosemide", uses: "Fluid retention, BP", alternatives: [{ name: "Furosemide 40mg", manufacturer: "Jan Aushadhi", price: 3, savings: 94 }] },
    "spironolactone": { category: "Diuretic", branded: "Aldactone 25mg", brandedPrice: 80, activeIngredient: "Spironolactone", uses: "Fluid retention", alternatives: [{ name: "Spironolactone 25mg", manufacturer: "Jan Aushadhi", price: 6, savings: 93 }] },
    "digoxin": { category: "Heart", branded: "Lanoxin 0.25mg", brandedPrice: 60, activeIngredient: "Digoxin", uses: "Heart failure", alternatives: [{ name: "Digoxin 0.25mg", manufacturer: "Jan Aushadhi", price: 4, savings: 93 }] }
};

export const brandMapping = {
    "crocin": "paracetamol", "dolo": "paracetamol", "calpol": "paracetamol",
    "brufen": "ibuprofen", "combiflam": "ibuprofen",
    "disprin": "aspirin", "ecosprin": "aspirin",
    "glycomet": "metformin", "glucophage": "metformin",
    "amaryl": "glimepiride",
    "amlong": "amlodipine", "amlokind": "amlodipine",
    "tenormin": "atenolol",
    "losar": "losartan", "repace": "losartan",
    "lipitor": "atorvastatin", "atorva": "atorvastatin",
    "omez": "omeprazole",
    "pan": "pantoprazole",
    "aciloc": "ranitidine",
    "zyrtec": "cetirizine", "cetrizet": "cetirizine",
    "montair": "montelukast",
    "asthalin": "salbutamol",
    "azithral": "azithromycin",
    "mox": "amoxicillin", "amoxil": "amoxicillin",
    "cifran": "ciprofloxacin",
    "doxy": "doxycycline",
    "eltroxin": "levothyroxine", "thyronorm": "levothyroxine",
    "voveran": "diclofenac", "voltaren": "diclofenac",
    "ultracet": "tramadol",
    "gabapin": "gabapentin",
    "lyrica": "pregabalin",
    "lantus": "insulin", "humalog": "insulin",
    "plavix": "clopidogrel",
    "coumadin": "warfarin",
    "lasix": "furosemide",
    "aldactone": "spironolactone",
    "lanoxin": "digoxin"
};

export function fuzzySearch(query) {
    if (!query) return [];
    const q = query.toLowerCase().trim();
    const results = [];
    
    for (const [key, data] of Object.entries(expandedMedicineDB)) {
        let score = 0;
        if (key === q) score = 100;
        else if (key.startsWith(q)) score = 80;
        else if (key.includes(q)) score = 60;
        else if (data.activeIngredient.toLowerCase().includes(q)) score = 70;
        else if (data.branded.toLowerCase().includes(q)) score = 50;
        
        if (score > 0) results.push({ key, data, score });
    }
    
    for (const [brand, generic] of Object.entries(brandMapping)) {
        if (brand.includes(q) && !results.find(r => r.key === generic)) {
            results.push({ key: generic, data: expandedMedicineDB[generic], score: 75 });
        }
    }
    
    return results.sort((a, b) => b.score - a.score).slice(0, 5);
}
